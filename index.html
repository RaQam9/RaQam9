<script>
    document.addEventListener('DOMContentLoaded', () => {
        const predictionsBtn = document.getElementById('nav-predictions-btn');
        const newsBtn = document.getElementById('nav-news-btn');
        const predictionsPage = document.getElementById('predictions-page');
        const newsPage = document.getElementById('news-page');
        function switchPage(pageToShow) { 
            if (typeof gtag !== 'undefined') {
                gtag('event', 'select_content', {
                    'content_type': 'tab',
                    'item_id': pageToShow
                });
            }
            if (pageToShow === 'predictions') { predictionsPage.classList.remove('hidden'); newsPage.classList.add('hidden'); predictionsBtn.classList.add('bg-blue-600', 'text-white'); predictionsBtn.classList.remove('text-gray-400'); newsBtn.classList.remove('bg-blue-600', 'text-white'); newsBtn.classList.add('text-gray-400'); } else { newsPage.classList.remove('hidden'); predictionsPage.classList.add('hidden'); newsBtn.classList.add('bg-blue-600', 'text-white'); newsBtn.classList.remove('text-gray-400'); predictionsBtn.classList.remove('bg-blue-600', 'text-white'); predictionsBtn.classList.add('text-gray-400'); } 
        }
        predictionsBtn.addEventListener('click', () => switchPage('predictions'));
        newsBtn.addEventListener('click', () => switchPage('news'));
        initializePredictionsPage();
        initializeNewsPage();
    });

    // ======================================================================
    // SECTION 1: PREDICTIONS PAGE LOGIC (DATABASE-POWERED)
    // ======================================================================
    
    // --- ุฏูุงู ูุณุงุนุฏุฉ ููุณู ุงูุชููุนุงุช ---

    function getMatchStatus(matchDateStr) { 
        const matchDate = new Date(matchDateStr); 
        const now = new Date(); 
        const diffMinutes = (matchDate.getTime() - now.getTime()) / 60000; 
        if (diffMinutes < -125) return { state: 'ended' }; 
        if (diffMinutes <= 0) return { state: 'live' }; 
        if (diffMinutes <= 5) return { state: 'soon' }; 
        return { state: 'scheduled' }; 
    }

    function renderMatchesForDay(dayContentContainer, matches) { 
        dayContentContainer.innerHTML = ''; 
        if (!matches || matches.length === 0) return; 
        matches.forEach(match => { 
            const matchDate = new Date(match.datetime); 
            const dateString = matchDate.toLocaleDateString('ar-EG', { weekday: 'long', day: 'numeric', month: 'long' }); 
            const timeString = matchDate.toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit', hour12: true });
            const statusInfo = getMatchStatus(match.datetime); 
            let statusDisplay; 
            switch (statusInfo.state) { 
                case 'ended': statusDisplay = `<span class="match-status ended">ุงูุชูุช</span>`; break; 
                case 'live': statusDisplay = `<span class="match-status live">ูุจุงุดุฑ</span>`; break; 
                case 'soon': statusDisplay = `<span class="match-status soon">ุจุนุฏ ูููู</span>`; break; 
                default: statusDisplay = `<div class="match-time">${timeString}</div>`; 
            } 
            const channels = (match.channels && match.channels.length > 0) ? match.channels.join(' / ') : "ุบูุฑ ูุญุฏุฏุฉ"; 
            const isMatchOver = statusInfo.state === 'ended'; 
            const card = document.createElement('div'); 
            card.className = 'match-card'; 
            card.dataset.matchId = match.id; 
            const matchName = `${match.team1.name} vs ${match.team2.name}`;
            card.innerHTML = `
                <div class="match-header"><span class="match-league">${match.league}</span><span class="match-date-time">${dateString}</span></div>
                <div class="match-body">
                    <div class="teams-row">
                        <div class="team"><img src="${match.team1.logo}" alt="${match.team1.name}" onerror="this.onerror=null;this.src='https://via.placeholder.com/50';"><span class="team-name">${match.team1.name}</span></div>
                        <div class="match-status-container">${statusDisplay}</div>
                        <div class="team"><img src="${match.team2.logo}" alt="${match.team2.name}" onerror="this.onerror=null;this.src='https://via.placeholder.com/50';"><span class="team-name">${match.team2.name}</span></div>
                    </div>
                    <form name="prediction-form" class="prediction-form ${isMatchOver ? 'disabled' : ''}" data-netlify="true">
                        <input type="hidden" name="form-name" value="prediction-form" />
                        <input type="hidden" name="match_name" value="${matchName}" />
                        <input type="hidden" name="league" value="${match.league}" />
                        <div class="form-group">
                            <legend class="channel-info"><i class="fa-solid fa-tv"></i> <span>${channels}</span></legend>
                        </div>
                        <div class="form-group">
                            <legend>ุชููุน ุงููุชูุฌุฉ:</legend>
                            <div class="prediction-options">
                                <input type="radio" name="winner" id="win1-${match.id}" value="${match.team1.name}" required><label for="win1-${match.id}">${match.team1.name}</label>
                                <input type="radio" name="winner" id="draw-${match.id}" value="ุชุนุงุฏู"><label for="draw-${match.id}">ุชุนุงุฏู</label>
                                <input type="radio" name="winner" id="win2-${match.id}" value="${match.team2.name}"><label for="win2-${match.id}">${match.team2.name}</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <legend>ูู ุณูุณุฌู ุฃููุงูุ (ุงุฎุชูุงุฑู)</legend>
                            <input type="text" name="scorer" class="scorer-input" placeholder="ุงูุชุจ ุงุณู ุงููุงุนุจ...">
                        </div>
                        <div class="form-group">
                            <button type="submit" class="submit-btn">${isMatchOver ? 'ุฃุบููุช ุงูุชููุนุงุช' : 'ุฅุฑุณุงู ุงูุชููุน'}</button>
                        </div>
                    </form>
                </div>
                <div class="match-footer">
                    <button class="toggle-comments-btn" ${isMatchOver ? 'disabled' : ''}>๐ฌ ุงูุชุนูููุงุช</button>
                    <div class="comments-section" style="display:none;">
                        <div class="comment-list"></div>
                        <form name="match-comment-form" class="comment-form" data-netlify="true">
                            <input type="hidden" name="form-name" value="match-comment-form" />
                            <input type="hidden" name="match_name" value="${matchName}" />
                            <textarea name="comment_text" placeholder="ุฃุถู ุชุนูููู..." required></textarea>
                            <button type="submit">ุฅุฑุณุงู</button>
                        </form>
                    </div>
                </div>
            `; 
            dayContentContainer.appendChild(card); 
        }); 
    }

    function attachTabEventListeners() { 
        const dateTabsContainer = document.getElementById('date-tabs');
        dateTabsContainer.addEventListener('click', (e) => { 
            if (!e.target.classList.contains('date-tab')) return; 
            const tabId = e.target.dataset.tabId; 
            document.querySelectorAll('.date-tab').forEach(tab => tab.classList.remove('active')); 
            e.target.classList.add('active'); 
            document.querySelectorAll('.day-content').forEach(content => content.classList.remove('active')); 
            document.getElementById(`day-${tabId}`).classList.add('active'); 
        }); 
    }
            
    function attachMatchEventListeners() { 
        const daysContentContainer = document.getElementById('days-content-container');
        const userIconBtn = document.getElementById('user-icon-btn'); 
        const dismissIconBtn = document.getElementById('dismiss-icon-btn'); 
        const closeModalBtn = document.getElementById('close-modal-btn'); 
        const userModal = document.getElementById('user-modal'); 
        const userInfoForm = document.getElementById('user-info-form'); 
        userIconBtn.addEventListener('click', openUserModal); 
        dismissIconBtn.addEventListener('click', dismissFloatingIcon); 
        closeModalBtn.addEventListener('click', closeUserModal); 
        userModal.addEventListener('click', (e) => { if (e.target === userModal) closeUserModal(); }); 
        userInfoForm.addEventListener('submit', saveUserInfo); 
        daysContentContainer.addEventListener('submit', e => { 
            e.preventDefault();
            if (e.target.classList.contains('prediction-form') || e.target.classList.contains('comment-form')) { 
                handleFormSubmit(e.target); 
            }
        }); 
        daysContentContainer.addEventListener('click', e => { 
            if (e.target.classList.contains('toggle-comments-btn')) handleToggleComments(e.target); 
        }); 
    }

    function openUserModal() { document.getElementById('user-modal').classList.add('show'); }
    function closeUserModal() { document.getElementById('user-modal').classList.remove('show'); }
    function dismissFloatingIcon() { document.getElementById('floating-icon-container').classList.add('hidden'); sessionStorage.setItem('isIconDismissed', 'true'); }
    
    function saveUserInfo(e) { 
        e.preventDefault(); 
        const userModal = document.getElementById('user-modal'); 
        const saveStatus = document.getElementById('save-status'); 
        const userInfo = { username: userModal.querySelector('#username').value.trim(), social: userModal.querySelector('#social_account').value.trim() }; 
        if (!userInfo.username) { alert('ุงูุฑุฌุงุก ุฅุฏุฎุงู ุงุณู ุงููุณุชุฎุฏู.'); return; } 
        localStorage.setItem('userInfo', JSON.stringify(userInfo)); 
        saveStatus.textContent = 'ุชู ุงูุญูุธ โ'; 
        setTimeout(() => { saveStatus.textContent = ''; closeUserModal(); }, 1500); 
    }
    
    function loadUserInfo() { const userInfo = JSON.parse(localStorage.getItem('userInfo')); if (userInfo) { document.getElementById('username').value = userInfo.username || ''; document.getElementById('social_account').value = userInfo.social || ''; } }
    
    function populateTicker() { 
        const tickerMessages = ["๐ ุณูุชู ุชูุฑูู ุฃูุถู ุงููุชููุนูู ูู ููุงูุฉ ูู ุฃุณุจูุน!", "๐ก ุชุฃูุฏ ูู ุญูุธ ุจูุงูุงุชู ูููุดุงุฑูุฉ ูู ุงูุณุญุจ.", "๐ฅ ุชุงุจุนููุง ูู ุชุบุทูุฉ ุฎุงุตุฉ ููุจุงุฑูุงุช ูุฃุณ ุงูุนุงูู ููุฃูุฏูุฉ."];
        document.getElementById('predictions-ticker-content').innerHTML = tickerMessages.map(msg => `<span class="ticker-item">${msg}</span>`).join(''); 
    }
    
    function handleFormSubmit(form) {
        const submitBtn = form.querySelector('button[type="submit"]');
        const originalText = submitBtn.innerHTML;
        submitBtn.innerHTML = `<i class="fa-solid fa-spinner fa-spin"></i>`;
        submitBtn.disabled = true;

        const userInfo = JSON.parse(localStorage.getItem('userInfo')) || {};
        const formData = new FormData(form);
        formData.append('username', userInfo.username || 'ูุฌููู');
        formData.append('social_account', userInfo.social || 'ูุง ููุฌุฏ');

        fetch("/", {
            method: "POST",
            headers: { "Content-Type": "application/x-www-form-urlencoded" },
            body: new URLSearchParams(formData).toString(),
        })
        .then(() => {
            if (form.classList.contains('prediction-form')) {
                submitBtn.innerHTML = `ุชู ุงูุฅุฑุณุงู โ`;
                [...form.elements].forEach(el => el.disabled = true);
                const matchCard = form.closest('.match-card');
                const prediction = { 
                    winner: form.querySelector('input[name="winner"]:checked').value,
                    scorer: form.querySelector('input[name="scorer"]').value.trim() 
                };
                localStorage.setItem(`prediction-${matchCard.dataset.matchId}`, JSON.stringify(prediction));
            } else if (form.classList.contains('comment-form')) {
                submitBtn.innerHTML = "ุฅุฑุณุงู";
                submitBtn.disabled = false;
                const matchCard = form.closest('.match-card');
                const commentList = form.closest('.comments-section').querySelector('.comment-list');
                const commentText = form.querySelector('textarea').value;
                const commentData = { author: userInfo.username || 'ูุฌููู', text: commentText };
                addCommentToDOM(commentList, commentData);
                const comments = JSON.parse(localStorage.getItem(`comments-${matchCard.dataset.matchId}`) || '[]');
                comments.push(commentData);
                localStorage.setItem(`comments-${matchCard.dataset.matchId}`, JSON.stringify(comments));
                form.querySelector('textarea').value = '';
            }
        })
        .catch((error) => {
            alert('ุญุฏุซ ุฎุทุฃ. ุงูุฑุฌุงุก ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู.');
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
        });
    }

    function handleToggleComments(button) { const commentsSection = button.nextElementSibling; const isHidden = commentsSection.style.display === 'none' || !commentsSection.style.display; commentsSection.style.display = isHidden ? 'block' : 'none'; button.innerHTML = isHidden ? '๐ฌ ุฅุฎูุงุก ุงูุชุนูููุงุช' : '๐ฌ ุงูุชุนูููุงุช'; }
    
    function addCommentToDOM(commentList, commentData) { 
        const newComment = document.createElement('div'); 
        newComment.className = 'comment'; 
        newComment.innerHTML = `<div class="comment-avatar"><i class="fa-solid fa-user"></i></div><div class="comment-body"><span class="comment-author">${commentData.author}</span><p class="comment-text">${commentData.text}</p></div>`; 
        commentList.appendChild(newComment); 
    }
    
    function loadFromStorage() { 
        document.querySelectorAll('.match-card').forEach(card => { 
            const matchId = card.dataset.matchId; 
            const savedPrediction = localStorage.getItem(`prediction-${matchId}`); 
            if (savedPrediction) { 
                const prediction = JSON.parse(savedPrediction); 
                const form = card.querySelector('.prediction-form'); 
                const winnerInput = form.querySelector(`input[value="${prediction.winner}"]`); 
                if (winnerInput) winnerInput.checked = true; 
                form.querySelector('.scorer-input').value = prediction.scorer; 
                [...form.elements].forEach(el => el.disabled = true); 
                form.querySelector('.submit-btn').innerHTML = 'ุชู ุงูุฅุฑุณุงู โ'; 
            } 
            const savedComments = JSON.parse(localStorage.getItem(`comments-${matchId}`) || '[]'); 
            const commentList = card.querySelector('.comment-list'); 
            savedComments.forEach(comment => addCommentToDOM(commentList, comment)); 
        }); 
    }
            
    // --- ุงูุฏุงูุฉ ุงูุฑุฆูุณูุฉ ุงูุชู ุชุดุบู ูู ุดูุก ---
    function initializePredictionsPage() {
        const floatingIconContainer = document.getElementById('floating-icon-container');

        // ุงูููุฏ ุงูุฐู ูุงู ููุง ุณุงุจูุงูุ ุชู ูููู ุฅูู ุฏุงูุฉ ูููุตูุฉ
        const manualMatchesData = [
             { "id": 2301, "team1": { "name": "ูุงูุดุณุชุฑ ุณูุชู", "logo": "https://media.api-sports.io/football/teams/50.png" }, "team2": { "name": "ุงูุนูู", "logo": "https://cdn.sportfeeds.io/sdl/images/team/crest/medium/2sHjUCuU5YFqVTNH4hDhu.png?quality=60&auto=webp&format=pjpg" }, "league": "ูุฃุณ ุงูุนุงูู ููุฃูุฏูุฉ", "datetime": "2025-06-23T02:00:00+01:00", "channels": ["DAZN"] },
             { "id": 2302, "team1": { "name": "ุฃุชูุชููู ูุฏุฑูุฏ", "logo": "https://media.api-sports.io/football/teams/530.png" }, "team2": { "name": "ุจูุชุงููุบู", "logo": "https://media.api-sports.io/football/teams/1081.png" }, "league": "ูุฃุณ ุงูุนุงูู ููุฃูุฏูุฉ", "datetime": "2025-06-23T20:00:00+01:00", "channels": ["DAZN"] }
        ];

        // ูุฐุง ูู ุงูุงุณุชุฏุนุงุก ุงูุฐู ูุงู ูุงูุตูุง!
        initializeAppWithData(manualMatchesData);
    }
    
    // ==========================================================
    // SECTION 2: NEWS PAGE LOGIC (STABLE VERSION)
    // ==========================================================
    function initializeNewsPage() {
        // ... ูู ููุฏ ุตูุญุฉ ุงูุฃุฎุจุงุฑ ูุจูู ููุง ูู ...
        const ADMIN_PASSWORD = '1122';
        const getTodaysDateString = (offsetDays=0)=>{const today = new Date();today.setDate(today.getDate() - offsetDays);const yyyy = today.getFullYear();const mm = String(today.getMonth() + 1).padStart(2, '0');const dd = String(today.getDate()).padStart(2, '0');return `${yyyy}-${mm}-${dd}`};
        let articlesData = [
            {"id":5,"title":"ุฅุณุชููุงู ููููุงู.. ุฃูุซุฑ ูุงุนุจ ูุญุธูุธ ูู ุงูุนุงูู!","image":"https://f.top4top.io/p_3462yrvqf0.jpg","publishDate":"2025-06-24","badge":"hot","fullText":"<p>ูู ูุจุงุฑุงุฉ ูุฏููุฉ ุฌูุนุช ุจุงูููุฑุงุณ ุงูุจุฑุงุฒููู ูุฅูุชุฑ ููุงูู ุงูุฃููุฑููุ ุฎุทู ุงููุฌู ุงูุดุงุจ ุฅุณุชููุงู ููููุงู ุงูุฃุถูุงุก ุจููุทุฉ ูู ููุณุงูุง ุทููุฉ ูุณูุฑุชู.</p><p>ููููุงูุ ุงูุฐู ูู ูุชุฌุงูุฒ 17 ุนุงููุง ุจุนุฏุ ุงุณุชุบู ูุฑุตุฉ ูุดุงุฑูุชู ุฃูุงู ุฃุณุงุทูุฑ ุงููุนุจุฉ ููููู ุจุชุจุงุฏู ุงูููุตุงู ูุน ูููููู ููุณู ุจูู ุดูุทู ุงูููุงุกุ ูุณุท ุฏูุดุฉ ุงูุฌูุงููุฑ.</p><p>ููู ุงูููุงุฌุฃุฉ ุงูุฃูุจุฑ ูุงูุช ุนูุจ ููุงูุฉ ุงููุจุงุฑุงุฉุ ุนูุฏูุง ุชูุฌูู ูุจุงุดุฑุฉ ุฅูู ูููุณ ุณูุงุฑูุฒ ูุชุจุงุฏู ุงููููุต ูุนู ุฃูุถูุงุ ููุฌูุน ุจูู ูููุตู ุงุซููู ูู ุฃุนุธู ุงููุงุนุจูู ูู ุชุงุฑูุฎ ูุฑุฉ ุงููุฏู.</p><p>ูุฐู ุงููุญุธุฉ ุงูุงุณุชุซูุงุฆูุฉ ุงูุชุดุฑุช ูุงููุงุฑ ูู ุงููุดูู ุนุจุฑ ููุงูุน ุงูุชูุงุตูุ ูุงุนุชุจุฑูุง ูุซูุฑูู ุฏูููุงู ุนูู ุฃู ุงููุฌู ุงูุตุงุนุฏ ูุนูุด ุญูููุง ูุง ูุนูุดู ุณูู ุงูููุงุฆู.</p><p>ุงูุตุญุงูุฉ ุงูุจุฑุงุฒูููุฉ ูุตูุช ุงูุฃูุฑ ุจุฃูู \"ุฃุณุจูุน ุงูุฃุญูุงู\" ูุฅุณุชููุงูุ ูููุง ุจุฏุฃ ุงููุชุงุจุนูู ูุชุณุงุกููู: ูู ูู ูุฌุฑุฏ ูุญุธูุธุ ุฃู ูุฌู ูุงุฏู ุจููุฉุ</p>"},
            {"id":4,"title":"ุณุงู ุฌูุฑูุงู ูุชุตุฏุฑ.. ูุฃุชูุชููู ูุฏุฑูุฏ ุฎุงุฑุฌ ุงููููุฏูุงู!","image":"https://e.top4top.io/p_3461all000.jpg","publishDate":"2025-06-23","badge":"hot","fullText":"<p>ุงูุชูุช ููุงูุณุงุช ุงููุฌููุนุฉ ุงูุซุงููุฉ ูู ูุฃุณ ุงูุนุงูู ููุฃูุฏูุฉ ุจูุชุงุฆุฌ ูุซูุฑุฉ ูููุงุฌุขุช ูุฏููุฉุ ุฃุจุฑุฒูุง ุฎุฑูุฌ ุฃุชูุชููู ูุฏุฑูุฏ ูู ุงูุฏูุฑ ุงูุฃูู ุฑุบู ุงูุชูุงูู ููุณ ุนุฏุฏ ุงูููุงุท ูุงููุชุตุฏุฑูู.</p><p>ุงููุฌู ุงููุบุฑุจู ุฃุดุฑู ุญูููู ูุงุฏ ูุฑููู ุจุงุฑูุณ ุณุงู ุฌูุฑูุงู ุฅูู ุงูููุฒ ุงูุฃุฎูุฑ ุงูุฐู ุถูู ุงูุตุฏุงุฑุฉ ุจูุงุฑู ุงูุฃูุฏุงูุ ุจุนุฏ ุฃุฏุงุก ููู ูุชุฃูู ูุงุถุญ ูู ุงูุฌุจูุฉ ุงููููู.</p><p>ูู ุงูููุงุจูุ ุชุฃูู ุจูุชุงููุฌู ุงูุจุฑุงุฒููู ุฅูู ุฏูุฑ ุงูู16 ุฑุบู ุงูุฎุณุงุฑุฉุ ูุณุชููุฏูุง ูู ุชูููู ุนูู ุฃุชูุชููู ูุฏุฑูุฏ ุจูุงุฑู ุงูุฃูุฏุงู ุงูุฅูุฌุงุจูุ ูู ูุงุญุฏุฉ ูู ุฃูุซุฑ ุงูุณููุงุฑูููุงุช ุฅุซุงุฑุฉ ูุฐุง ุงูููุณู.</p><p>ุฃูุง ุฃุชูุชูููุ ููุฏ ุฏูุน ุซูู ุงูุจุฏุงูุฉ ุงูุถุนููุฉุ ุญูุซ ูู ูุดูุน ูู ุงูููุฒ ุงูุฃุฎูุฑ ุจุณุจุจ ูุงุฑู ุงูุฃูุฏุงู ุงูุณูุจู ุงูุฐู ุฃุจูุงู ูู ุงููุฑูุฒ ุงูุซุงูุซ ุจุฑุตูุฏ 6 ููุงุท.</p><p>ุณูุงุชู ุงูุฃูุฑููู ูุงู ุงูุญููุฉ ุงูุฃุถุนู ูู ุงููุฌููุนุฉุ ุญูุซ ูุฏูุน ุงูุจุทููุฉ ุฏูู ุฃู ููุทุฉ ุจุนุฏ ุซูุงุซ ูุฒุงุฆู ูุชุชุงููุฉ ููุงุฑู ุฃูุฏุงู ูุจูุฑ ุจูุบ -5.</p>"},
            {"id":10,"title":"ูุงุจุฑุงู ูุฑุฏ: 'ฺูุงู ูุนููู' ููุณุช ุนูุตุฑูุฉ!","image":"https://b.top4top.io/p_3461gr2b90.jpg","publishDate":"2025-06-23","badge":"hot","fullText":"<p>ูู ูุงุญุฏุฉ ูู ุฃุจุฑุฒ ููุทุงุช ูุฃุณ ุงูุนุงูู ููุฃูุฏูุฉุ ุงูุชูุทุช ุงููุงููุฑุงุช ููุงุฌูุฉ ูุงุฑูุฉ ุจูู ุฃูุทูููู ุฑูุฏูุฌุฑ ูุฌูุณุชุงูู ูุงุจุฑุงูุ ุจุนุฏ ุฃู ุจุฏุง ุฃู ุงูุฃูู ุดุนุฑ ุจุฅูุงูุฉ ุนูุตุฑูุฉ ูุฌููุง ูู ูุงุนุจ ุจุงุชุดููุง.</p><p>ุฑุฏู ูุงุจุฑุงู ุฌุงุก ุณุฑูุนูุง ุนุจุฑ ุชุตุฑูุญ ูุซูุฑุ ูุงู ููู: 'ุงูุญูู ุฃุดุงุฑ ุจุงูุนูุตุฑูุฉุ ูุฃูุง ูุงุตูุช ุชูุฑุงุฑ ูุง ููุชู ูุฑูุฏูุฌุฑ ฺูุงู ูุนูููุ ููู ููู ููุงู ุฃู ุนูุตุฑูุฉ ูู ุฐููุ ููุง ูููููุง ูู ุงูุฃุฑุฌูุชููุ ุฅููุง ูุฌุฑุฏ ูููุฉ.'</p><p>ุงูุนุจุงุฑุฉ ุงูุชู ุงุณุชุฎุฏููุง ูุงุจุฑุงู ุชูุนุฏ ุดุงุฆุนุฉ ูู ุงูุฃุฑุฌูุชููุ ูุชููุงู ุฃุญูุงููุง ุฏุงุฎู ุงูููุงุนุจ ููุชุนุจูุฑ ุนู ุงูุชูุชุฑ ุฃู ุงูุบุถุจุ ุฏูู ููุฉ ุนูุตุฑูุฉุ ููููุง ูุฏ ุชุญูู ูุนุงูู ูุฎุชููุฉ ูู ุซูุงูุงุช ุฃุฎุฑูุ ูุง ุชุณุจุจ ูู ุณูุก ุงูููู.</p><p>ุงูุฌูุงููุฑ ุชูุงุนูุช ุจููุฉ ูุน ุงููุดูุฏุ ุจูู ูู ูุฑู ุฃู ุนูู ุงููุงุนุจูู ุงุญุชุฑุงู ุงุฎุชูุงู ุงูุฎูููุงุชุ ููู ูุฏุงูุน ุนู ูุงุจุฑุงู ูุคูุฏูู ุฃูู ูู ููุตุฏ ุงูุฅุณุงุกุฉุ ุฎุงุตุฉ ูุฃู ุฑูุฏูุฌุฑ ูุนุฑูู ุจุญุณุงุณูุชู ุชุฌุงู ูุถุงูุง ุงูุนูุตุฑูุฉ ุจุนุฏ ุชุฌุงุฑุจ ูุคููุฉ ุณุงุจูุฉ.</p><p>ุงูุญุงุฏุซุฉ ุชูุชุญ ูุฌุฏุฏูุง ููู ุงูุชูุงุตู ุจูู ุงูุซูุงูุงุช ูู ุงูููุงุนุจ ุงูุฏูููุฉุ ูุชุคูุฏ ุฃู ูุฑุฉ ุงููุฏูุ ุฑุบู ููููุง ุนุงูููุฉุ ุชุญุชุงุฌ ุฅูู ุญุณุงุณูุฉ ูุถุงุนูุฉ ุชุฌุงู ูุง ูููุงู ุฏุงุฎู ุงููุณุชุทูู ุงูุฃุฎุถุฑ.</p>"},
            {"id":3,"title":"ุงูููุงู ููุชุฑุจ ูู ุญุณู ุตููุฉ ุชูู ููุฑูุงูุฏูุฒ","image":"https://j.top4top.io/p_3461lgsle0.jpg","fullText":"<p>ุฃูุฏ ุงูุตุญูู ุงูููุซูู ูุงุจุฑูุฒูู ุฑููุงูู ุฃู ูุงุฏู ุงูููุงู ุงูุณุนูุฏู ุจุงุช ูุฑูุจูุง ููุบุงูุฉ ูู ุงูุชูููุน ูุน ุงููุฌู ุงููุฑูุณู ุชูู ููุฑูุงูุฏูุฒุ ุงูุธููุฑ ุงูุฃูุณุฑ ููุงุฏู ูููุงู ุงูุฅูุทุงูู. ุงูููุงูุถุงุช ุฏุฎูุช ูุฑุงุญููุง ุงูููุงุฆูุฉ ุจุนุฏ ุฃู ูุงูู ุงููุงุนุจ ุนูู ุงูุดุฑูุท ุงูุดุฎุตูุฉ.</p><p>ุงูููุงู ุฃุจุฏู ุฌุฏูุฉ ูุจูุฑุฉ ูู ุงูููุงูุถุงุชุ ุญูุซ ูุฏู ุนุฑุถูุง ูุบุฑููุง ููููุงู ูุชุฌุงูุฒ 70 ููููู ููุฑูุ ููู ูุง ุฌุนู ุงููุงุฏู ุงูุฅูุทุงูู ูุฏุฑุณ ุงูุนุฑุถ ุจุฌุฏูุฉุ ุฎุงุตุฉ ูู ุธู ุญุงุฌุชู ูุชูููู ุตููุงุช ุฃุฎุฑู. ุชูู ููุฑูุงูุฏูุฒ ููุนุฏ ูู ุฃูุถู ุงููุงุนุจูู ูู ูุฑูุฒู ุฎูุงู ุงูุณููุงุช ุงูุฃุฎูุฑุฉุ ูุณุงูู ุจุดูู ูุจูุฑ ูู ุชุชููุฌ ูููุงู ุจููุจ ุงูุฏูุฑู ุงูุฅูุทุงูู ููุณู 2021-2022. ูู ุญุงู ุฅุชูุงู ุงูุตููุฉุ ุณููุดูู ุชูู ุฅุถุงูุฉ ููุนูุฉ ูุฏูุงุน ููุฌูู ุงูููุงู ูู ุงูููุณู ุงูููุจู ุงูุฐู ูุดูุฏ ูุดุงุฑูุงุช ุนุงูููุฉ.</p>"}
        ];
        const newsHomePage=document.querySelector('#news-page #home-page');const newsArticlePage=document.querySelector('#news-page #article-page');const articlesGrid=document.querySelector('#news-page #articles-grid');const articleContent=document.querySelector('#news-page #article-content');const notificationToast=document.querySelector('#news-page #notification-toast');const exitToast=document.getElementById('exit-toast');let currentArticleId=null;let currentNewsSubPage='home';let firstBackPressTime=0;function showToast(message,type='success',duration=3000){notificationToast.textContent=message;notificationToast.className=`show ${type}`;setTimeout(()=>{notificationToast.classList.remove('show')},duration)}function navigateToNewsSubPage(pageName){currentNewsSubPage=pageName;if(pageName==='article'){newsHomePage.style.transform='translateX(-100%)';newsArticlePage.style.transform='translateX(0)'}else{newsHomePage.style.transform='translateX(0)';newsArticlePage.style.transform='translateX(100%)'}}function showArticle(articleId){const article=articlesData.find(a=>a.id===articleId);if(!article)return;currentArticleId=article.id;if(typeof gtag!=='undefined'){gtag('event','view_item',{'item_name':article.title})}articleContent.innerHTML=`
                    <div id="article-header">
                        <h1>${article.title}</h1>
                        <button id="share-button" title="ูุดุงุฑูุฉ ุงูุฎุจุฑ"><i class="fa-solid fa-share-nodes"></i></button>
                    </div>
                    <img src="${article.image}" alt="${article.title}">
                    ${article.fullText}
                `;document.getElementById('article-title-hidden-input').value=article.title;document.getElementById('share-button').addEventListener('click',()=>{if(typeof gtag!=='undefined'){gtag('event','share',{'method':'Native/Clipboard','content_type':'article','item_id':article.title})}const shareData={title:article.title,text:`ุดุงูุฏ ูุฐุง ุงูุฎุจุฑ: ${article.title}`,url:window.location.href};if(navigator.share){navigator.share(shareData).catch(console.error)}else{navigator.clipboard.writeText(`${shareData.text}\n${shareData.url}`).then(()=>showToast('ุชู ูุณุฎ ุฑุงุจุท ุงูุฎุจุฑ!')).catch(err=>alert('ูุดู ูุณุฎ ุงูุฑุงุจุท.'))}});loadComments(currentArticleId);newsArticlePage.scrollTop=0;navigateToNewsSubPage('article')}function buildHomePage(){articlesGrid.innerHTML='';articlesData.forEach(article=>{const card=document.createElement('div');card.className='article-card';card.innerHTML=`<img src="${article.image}" alt="${article.title}"><div class="article-title"><h3>${article.title}</h3></div>`;card.addEventListener('click',()=>showArticle(article.id));articlesGrid.appendChild(card)})}function loadComments(articleId){const commentsList=document.querySelector('#news-page #comments-list');const comments=JSON.parse(localStorage.getItem(`comments_${articleId}`))||[];commentsList.innerHTML='';if(comments.length===0){commentsList.innerHTML='<p style="color: var(--secondary-text-color); text-align: center;">ูุง ุชูุฌุฏ ุชุนูููุงุช. ูู ุฃูู ูู ูุนูู!</p>';return}comments.slice().reverse().forEach(comment=>{const commentElement=document.createElement('div');commentElement.className='comment-item';const safeAuthor=document.createTextNode(comment.name||'ูุฌููู').textContent;const safeText=document.createTextNode(comment.text).textContent;const commentDate=new Date(comment.date).toLocaleString('ar-EG',{dateStyle:'short',timeStyle:'short'});commentElement.innerHTML=`<button class="delete-comment-btn" onclick="handleNewsDeleteComment(${articleId},'${comment.date}')" title="ุญุฐู ุงูุชุนููู"><i class="fa-solid fa-trash"></i></button><div class="comment-header"><span class="comment-author">${safeAuthor}</span><span class="comment-date">${commentDate}</span></div><p class="comment-body">${safeText}</p>`;commentsList.appendChild(commentElement)})}function handleNewsCommentSubmit(event){event.preventDefault();const form=event.target;const nameInput=document.getElementById('comment-name');const textInput=document.getElementById('comment-text');const submitBtn=document.getElementById('submit-comment-btn');const name=nameInput.value.trim();const text=textInput.value.trim();if(!text)return;submitBtn.disabled=true;submitBtn.textContent='ุฌุงุฑู ุงูุฅุฑุณุงู...';const formData=new FormData(form);fetch("/",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(formData).toString()}).then(()=>{const comments=JSON.parse(localStorage.getItem(`comments_${currentArticleId}`))||[];const newComment={name:name||'ูุฌููู',text:text,date:new Date().toISOString()};comments.push(newComment);localStorage.setItem(`comments_${currentArticleId}`,JSON.stringify(comments));loadComments(currentArticleId);showToast('ุชู ุฅุฑุณุงู ุชุนูููู ุจูุฌุงุญ!')}).catch(error=>{showToast('ูุดู ุฅุฑุณุงู ุงูุชุนููู.','error')}).finally(()=>{submitBtn.disabled=false;submitBtn.textContent='ุฅุฑุณุงู ุงูุชุนููู';nameInput.value='';textInput.value=''})}window.handleNewsDeleteComment=function(articleId,commentDate){const password=prompt("ููุชุญููุ ูุฑุฌู ุฅุฏุฎุงู ูููุฉ ูุฑูุฑ ุงููุฏูุฑ:");if(password===ADMIN_PASSWORD){let comments=JSON.parse(localStorage.getItem(`comments_${articleId}`))||[];comments=comments.filter(c=>c.date!==commentDate);localStorage.setItem(`comments_${articleId}`,JSON.stringify(comments));loadComments(articleId);showToast('ุชู ุญุฐู ุงูุชุนููู ุจูุฌุงุญ.')}else if(password!==null){alert("ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ!")}}document.querySelector('#news-page #comment-form').addEventListener('submit',handleNewsCommentSubmit);let touchStartX=0;let isSwiping=false;newsArticlePage.addEventListener('touchstart',e=>{if(e.changedTouches[0].screenX<50||e.changedTouches[0].screenX>window.innerWidth-50){touchStartX=e.changedTouches[0].screenX;isSwiping=true}});newsArticlePage.addEventListener('touchend',e=>{if(!isSwiping)return;isSwiping=false;const touchEndX=e.changedTouches[0].screenX;const swipeDistance=Math.abs(touchEndX-touchStartX);if(swipeDistance>75){navigateToNewsSubPage('home')}});document.addEventListener('backbutton',e=>{e.preventDefault();const newsPage=document.getElementById('news-page');if(!newsPage.classList.contains('hidden')&ยคtNewsSubPage==='article'){navigateToNewsSubPage('home')}else{if(new Date().getTime()-firstBackPressTime<2000){if(navigator.app&&navigator.app.exitApp){navigator.app.exitApp()}}else{firstBackPressTime=new Date().getTime();exitToast.classList.add('show');setTimeout(()=>{exitToast.classList.remove('show')},2000)}}},false);buildHomePage();
    }

</script>
</body>
</html>
